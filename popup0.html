<!DOCTYPE html>
<html>

<head>
  <script>
    function fnLaunch() {
      var aForm;
      aForm = document.getElementById('oForm').elements;
      var myObject = new Object();
      myObject.firstName = aForm.oFirstName.value;
      myObject.lastName = aForm.oLastName.value;
      // The object "myObject" is sent to the modal window.
      window.showModalDialog("https://agilcomm.github.io/chase/popup.html", myObject, "dialogHeight:300px; dialogLeft:200px;");
    }
  </script>
  
  

<script language="javascript">
<!--
function conditionalFormSubmit(prevValue, messageToLookFor, dropdownName, flagName, submitForm,cartId,custAcId,userId,respId,orgId,hopUrl)
{
  var windowForm        = document.forms[submitForm];
  var dropDownObj       = windowForm.elements[dropdownName];
  //1. checking to see what operation was chosen: choosing create/existing value OR blank/valid value
   //1-2. checking the previous value of the drop down
  var prevValEqualsMessage = (prevValue == messageToLookFor);

   //1-3. checking the current value of the drop down
  var currValEqualsMessage = false;
  if (dropDownObj != null)
  {
    for (var i=0; i < dropDownObj.length; i++)
    {
      if (dropDownObj.options[i].selected == true)
      {
        if (dropDownObj.options[i].value      == messageToLookFor)
        {
          currValEqualsMessage = true;
        }
        break;
      }
    }
  }

   //1-4. now figure out the flagValue:
  // true if create or blank
  if ((!prevValEqualsMessage && currValEqualsMessage) ||
      (prevValEqualsMessage && !currValEqualsMessage) )
  {
    windowForm.event.name = flagName;
   // windowForm.submit();
   var shaddr = encodeURIComponent(document.getElementById("addr_list").value);
   var biaddr = encodeURIComponent(document.getElementById("addr_listBILLTO").value);
   var shmethod = encodeURIComponent(document.getElementById("selectship_method").value);
   var shinstr = encodeURIComponent(document.getElementById("shippingInstr1").value);
   var pkinstr = encodeURIComponent(document.getElementById("packingInstr1").value);
   var url=hopUrl+'?form=ISTORE&tid='+cartId+'&tid1='+custAcId+'&user='+userId+'&resp='+respId+'&appl=671&ou='+orgId+"&shmethod="+shmethod+"&shinstr="+shinstr+"&pkinstr="+pkinstr;
  if(shaddr=="CREATE_ADDR" && biaddr=="SASA")
   {
	var addr1 = encodeURIComponent(document.getElementById("address1").value);
	var addr2 = encodeURIComponent(document.getElementById("address2").value);
	var city = encodeURIComponent(document.getElementById("city").value);
	var cnty = encodeURIComponent(document.getElementById("county").value);
	var stat = encodeURIComponent(document.getElementById("state").value);
	var pocode = encodeURIComponent(document.getElementById("zip").value);
	var cntry = encodeURIComponent(document.getElementById("dropdown").value);
	url=url+'&tid2=null&invaddr1='+addr1+'&invaddr2='+addr2+'&city='+city+'&county='+cnty+'&state='+stat+'&zip='+pocode+'&country='+cntry+'&shipaddr=Y&billaddr=N&shippsiteId=&billpsiteId=&biaddr='+biaddr;
   }else if(shaddr=="CREATE_ADDR" && biaddr!="SASA" && biaddr!="CREATE_ADDR")
   {
	var addr1 = encodeURIComponent(document.getElementById("address1").value);
	var addr2 = encodeURIComponent(document.getElementById("address2").value);
	var city = encodeURIComponent(document.getElementById("city").value);
	var cnty = encodeURIComponent(document.getElementById("county").value);
	var stat = encodeURIComponent(document.getElementById("state").value);
	var pocode = encodeURIComponent(document.getElementById("zip").value);
	var cntry = encodeURIComponent(document.getElementById("dropdown").value);
	biaddr=decodeURIComponent(biaddr);
	var len = biaddr.indexOf(":");
	var billpsiteId=biaddr.substring(0,len);
	url=url+'&tid2='+billpsiteId+'&invaddr1='+addr1+'&invaddr2='+addr2+'&city='+city+'&county='+cnty+'&state='+stat+'&zip='+pocode+'&country='+cntry+'&shipaddr=Y&billaddr=N'+'&billpsiteId='+billpsiteId+'&shippsiteId=&biaddr='+biaddr;
   }else if(biaddr=="CREATE_ADDR" && shaddr!="CREATE_ADDR")
   {
	var addr1 = encodeURIComponent(document.getElementById("address1BILLTO").value);
	var addr2 = encodeURIComponent(document.getElementById("address2BILLTO").value);
	var city = encodeURIComponent(document.getElementById("cityBILLTO").value);
	var cnty = encodeURIComponent(document.getElementById("countyBILLTO").value);
	var stat = encodeURIComponent(document.getElementById("stateBILLTO").value);
	var pocode = encodeURIComponent(document.getElementById("zipBILLTO").value);
	var cntry = encodeURIComponent(document.getElementById("dropdownBILLTO").value);
	shaddr=decodeURIComponent(shaddr);
	var len = shaddr.indexOf(":");
	var shippsiteId=shaddr.substring(0,len);
	url=url+'&tid2=null&invaddr1='+addr1+'&invaddr2='+addr2+'&city='+city+'&county='+cnty+'&state='+stat+'&zip='+pocode+'&country='+cntry+'&shipaddr=N&billaddr=Y'+'&shippsiteId='+shippsiteId+'&billpsiteId=&shaddr='+shaddr;
   }else if(shaddr!="CREATE_ADDR" && biaddr=="SASA")
   {
	shaddr=decodeURIComponent(shaddr);
	var len = shaddr.indexOf(":");
	var psiteId=shaddr.substring(0,len);
	url=url+'&tid2='+psiteId+'&shippsiteId='+psiteId+'&billpsiteId=&shipaddr=N&billaddr=N&shaddr='+shaddr;
   }
   else if(biaddr=="CREATE_ADDR" && shaddr=="CREATE_ADDR")
   {
	var addr1 = encodeURIComponent(document.getElementById("address1BILLTO").value);
	var addr2 = encodeURIComponent(document.getElementById("address2BILLTO").value);
	var city = encodeURIComponent(document.getElementById("cityBILLTO").value);
	var cnty = encodeURIComponent(document.getElementById("countyBILLTO").value);
	var stat = encodeURIComponent(document.getElementById("stateBILLTO").value);
	var pocode = encodeURIComponent(document.getElementById("zipBILLTO").value);
	var cntry = encodeURIComponent(document.getElementById("dropdownBILLTO").value);
	var shaddr1 = encodeURIComponent(document.getElementById("address1").value);
	var shaddr2 = encodeURIComponent(document.getElementById("address2").value);
	var shcity = encodeURIComponent(document.getElementById("city").value);
	var shcnty = encodeURIComponent(document.getElementById("county").value);
	var shstat = encodeURIComponent(document.getElementById("state").value);
	var shpocode = encodeURIComponent(document.getElementById("zip").value);
	var shcntry = encodeURIComponent(document.getElementById("dropdown").value);
	url=url+'&tid2=null&invaddr1='+addr1+'&invaddr2='+addr2+'&city='+city+'&county='+cnty+'&state='+stat+'&zip='+pocode+'&country='+cntry+'&shipaddr=Y&billaddr=Y&shippsiteId=&billpsiteId=&shinvaddr1='+shaddr1+'&shinvaddr2='+shaddr2+'&shcity='+shcity+'&shcounty='+shcnty+'&shstate='+shstat+'&shzip='+shpocode+'&shcountry='+shcntry;
   }else
   {
	shaddr=decodeURIComponent(shaddr);
	var slen = shaddr.indexOf(":");
	var shippsiteId=shaddr.substring(0,slen);
	biaddr=decodeURIComponent(biaddr)
	var len = biaddr.indexOf(":");
	var psiteId=biaddr.substring(0,len);
	url=url+'&tid2='+psiteId+'&shippsiteId='+shippsiteId+'&billpsiteId='+psiteId+'&shipaddr=N&billaddr=N&shaddr='+shaddr+'&biaddr='+biaddr;
   }
   window.open(url,'token','height=500,width=700,status=yes,scrollbars=yes,toolbar=no,menubar=no,location=no');
  }
  return true;

}
//-->
</script>
</head>

<body>
  <button onclick="fnLaunch();">Launch The Dialog</button>
  
    <span class="jttinvis"><label for="ccl"> Credit Card: Credit Card</label></span>

	  
      	<select name="assignmentId" id="ccl" size="1" onchange="clearCVV2(); conditionalFormSubmit(&#39;&#39;, &#39;-2&#39;, &#39;assignmentId&#39;, &#39;payOptnCreateSelCC.x&#39;, &#39;parentFormWithCartLineInfo&#39;,&#39;13343&#39;,&#39;1086648&#39;,&#39;32846&#39;,&#39;22372&#39;,&#39;405&#39;,&#39;https://agilcomm.github.io/chase/popup.html&#39;)">
      

       <option selected="" value="1218607">
          test  last VISA 1111,
          Unknown,
          XXXXXXXXXXXX1111,
          02/2019
         </option>  <option value="-2"> Create New Credit Card  </option> 

      	</select>

      	
  <form id="oForm">
    First Name:
    <input type="text" name="oFirstName" value="Jane">
    <br>
    Last Name:
    <input type="text" name="oLastName" value="Smith">
  </form>
</body>

</html>
